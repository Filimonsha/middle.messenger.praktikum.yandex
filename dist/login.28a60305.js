(()=>{function $parcel$export(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire94c2;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var n={id:e,exports:{}};return $parcel$modules[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire94c2=parcelRequire),parcelRequire.register("i3VVt",(function(e,t){$parcel$export(e.exports,"loginAndPasswordValidationHandle",(()=>u)),$parcel$export(e.exports,"LoginLayoutComponent",(()=>m));var n=parcelRequire("iADmr"),r=parcelRequire("g3obx"),i=parcelRequire("hXJG5"),l=parcelRequire("lRRib"),a=parcelRequire("7ImWG"),o=parcelRequire("jAQYi");class s extends n.Block{constructor(e){super(r.loginLayoutTemplate,e)}}const p=new(0,i.Validator),c={state:{type:"submit",text:"Enter"},events:{submit:e=>{console.log("Submit")}}},d={state:{type:"button",text:"Not register yet ?"},events:{click:e=>console.log("Пользователь нажал на регистрацию")}};function u(e,t){console.log(p.validate(t,e.value)),this.updateState("inputValue",e.value)}const m=new s({state:{logins:[new(0,l.Input)({state:{labelName:"login",inputValue:"some text"},events:{blur({target:e}){u.call(this,e,"login")},focus({target:e}){u.call(this,e,"login")}}}),new(0,l.Input)({state:{labelName:"password",inputValue:"another text"},events:{blur({target:e}){u.call(this,e,"password")},focus({target:e}){u.call(this,e,"password")}}})],MainButton:new(0,a.MainBtn)(c),DefaultButton:new(0,o.DefaultBtn)(d)},events:{submit(e){e.preventDefault(),console.log(this.getComponentChildren()),this.getComponentChildren().logins.forEach((e=>{const t=e.getState();console.error(p.validate(t.labelName,t.inputValue))}))}}})})),parcelRequire.register("iADmr",(function(e,t){$parcel$export(e.exports,"Block",(()=>i));var n=parcelRequire("feUZh"),r=parcelRequire("fAJEe");class i{eventBus=new(0,n.EventBus);componentId="component-"+1e3*Math.random();constructor(e,t){this.template=e,this.componentProps=t;const{children:n,simpleState:i}=this.findChildrenAndState(t.state);this.componentChildren=n,this.componentSimpleState=i,n&&this.createDummyChildren(),this.makeStateProxy(),this.registerEvents(),this.eventBus.notify(r.Events.INIT)}registerEvents=()=>{this.eventBus.subscribeCallbackOnEvent(r.Events.INIT,this.init.bind(this)),this.eventBus.subscribeCallbackOnEvent(r.Events.COMPONENT_DID_MOUNT,this.componentDidMount.bind(this)),this.eventBus.subscribeCallbackOnEvent(r.Events.COMPONENT_RENDER,this.render.bind(this)),this.eventBus.subscribeCallbackOnEvent(r.Events.COMPONENT_DID_UPDATE,this.componentDidUpdate.bind(this))};makeStateProxy=()=>{const e={set:(e,t,n)=>(e[t]=n,this.eventBus.notify(r.Events.COMPONENT_DID_UPDATE),!0)};this.componentState=new Proxy(this.componentProps.state,e)};init=()=>{(()=>{this.element=document.createElement("div")})(),this.eventBus.notify(r.Events.COMPONENT_RENDER)};componentDidMount(e){console.log("component did mount")}componentDidUpdate(){console.log(" Component Did update!"),this.eventBus.notify(r.Events.COMPONENT_RENDER)}render=()=>{this.element&&this.componentProps.events&&Object.keys(this.componentProps.events).forEach((e=>{this.element.removeEventListener(e,this.componentProps.events[e])})),this.element.innerHTML=this.template.compile(this.componentState),this.element=this.element.children[0],console.log(this.element.children),this.componentChildren&&this.renderChildren(),this.componentProps.events&&Object.keys(this.componentProps.events).forEach((e=>{this.element.addEventListener(e,this.componentProps.events[e].bind(this))}))};findChildrenAndState=e=>{const t={},n={};return Object.entries(e).forEach((([e,r])=>{Array.isArray(r)?r.every((e=>e instanceof i))&&(t[e]=[],r.forEach(((n,r)=>{t[e].push(n)}))):r instanceof i?t[e]=r:n[e]=r})),{children:t,simpleState:n}};createDummyChildren(){Object.entries(this.componentChildren).forEach((e=>{const t=e[0],n=e[1];if(Array.isArray(n))n.forEach(((e,n)=>{const r=`\n                <div id=${e.componentId}></div>\n            `;this.componentProps.state[t][n]=r}));else{const e=`\n                <div id=${n.componentId}></div>\n            `;this.componentProps.state[t]=e}}))}renderChildren(){const e=e=>{const t=`#${e.componentId.toString()}`,n=this.element.querySelector(t);if(!n)throw new Error("In template didnt find children layout!");console.error(n),n.replaceWith(e.getCompiledElement())};Object.values(this.componentChildren).forEach((t=>{Array.isArray(t)?t.forEach(e):e(t)}))}updateState=(e,t)=>{this.componentState[e]=t};getState=()=>({...this.componentState});getComponentChildren=()=>({...this.componentChildren});getCompiledElement=()=>this.element;renderDom=e=>{document.querySelector(e).appendChild(this.element),this.eventBus.notify(r.Events.COMPONENT_DID_MOUNT)}}})),parcelRequire.register("feUZh",(function(e,t){$parcel$export(e.exports,"EventBus",(()=>n));class n{listeners={};constructor(){}subscribeCallbackOnEvent(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}unSubscribeCallbackFromEvent(e,t){if(!this.listeners[e])throw new Error("This event does not exist");this.listeners[e]=this.listeners[e].filter((e=>e!==t))}notify(e,...t){if(!this.listeners[e])throw new Event(`Нет события: ${e}`);this.listeners[e].forEach((e=>{e(...t)}))}}})),parcelRequire.register("fAJEe",(function(e,t){let n;var r;$parcel$export(e.exports,"Events",(()=>n)),(r=n||(n={})).INIT="init",r.COMPONENT_DID_MOUNT="ComponentDidMount",r.COMPONENT_RENDER="ComponentRender",r.COMPONENT_DID_UNMOUNT="ComponentDidUnmount",r.COMPONENT_DID_UPDATE="ComponentDidUpdate"})),parcelRequire.register("g3obx",(function(e,t){$parcel$export(e.exports,"loginLayoutTemplate",(()=>n));const n=new(0,parcelRequire("lsS9H").Template)('\n    <div class="login">\n        <div class="login_container">\n            <h1 class="login_title">Вход</h1>\n            <form class="login_form">\n            {{!logins!}}\n             \n             <div class="login_buttons">\n                {{!MainButton!}}\n                {{!DefaultButton!}}\n            </div>\n            </form>\n        </div>\n    </div>\n')})),parcelRequire.register("lsS9H",(function(module,exports){$parcel$export(module.exports,"Template",(()=>Template));var $dXPMl=parcelRequire("dXPMl"),$531dJ=parcelRequire("531dJ");class Template{constructor(e){this.initialTemplate=e,this.modifyTemplate=this.initialTemplate}compile(e){const t=this.foundDynamicRegexp(e);return this.modifyTemplate=this.initialTemplate,t}getProperty(e,t){const n=t.split(".");let r,i=e;for(const e of n){if(r=i[e],!r)return;i=r}return r}foundDynamicRegexp(e){this.renderSimpleVariables(e);return $531dJ.RegexpHandler.handAllFoundRegexp($dXPMl.TEMPLATE_DYNAMIC_REGEXP,this.modifyTemplate,((e,t)=>{e.match($dXPMl.TEMPLATE_IF_THEN_REGEXP)&&this.renderCondition(e,t)})),this.replaceAllDynamicRegExp(),this.modifyTemplate}replaceAllDynamicRegExp(){$531dJ.RegexpHandler.handAllFoundRegexp($dXPMl.TEMPLATE_DYNAMIC_REGEXP,this.modifyTemplate,((e,t)=>this.modifyTemplate=this.modifyTemplate.replace(t,e)),!1)}renderSimpleVariables(e){$531dJ.RegexpHandler.handAllFoundRegexp($dXPMl.TEMPLATE_VARIABLES_REGEXP,this.modifyTemplate,((t,n)=>{const r=this.getProperty(e,t);if(t){const e=Array.isArray(r)&&r.every((e=>"string"==typeof e&&e.trim().startsWith("<div id=component-")));this.modifyTemplate=this.modifyTemplate.replace(new RegExp(n,"gi"),e?r.join(""):r)}}))}renderCondition(foundedDynamicReg,foundedMatch){const foundedConditionArgs=$dXPMl.TEMPLATE_IF_THEN_REGEXP.exec(foundedDynamicReg),condition=eval(foundedConditionArgs[1]),ifSuccessThen=foundedConditionArgs[2],ifFalseThen=foundedConditionArgs[3];condition?this.modifyTemplate=this.modifyTemplate.replace(foundedMatch,ifSuccessThen):ifFalseThen&&(this.modifyTemplate=this.modifyTemplate.replace(foundedMatch,""))}}})),parcelRequire.register("dXPMl",(function(e,t){$parcel$export(e.exports,"TEMPLATE_DYNAMIC_REGEXP",(()=>n)),$parcel$export(e.exports,"TEMPLATE_IF_THEN_REGEXP",(()=>r)),$parcel$export(e.exports,"TEMPLATE_VARIABLES_REGEXP",(()=>i));const n=new RegExp(/\{\{([\s\S]*?)\}\}/gi),r=new RegExp(/if\((.*?)\)then{(.*?)}(else{(.*?)})?/gi),i=new RegExp(/!(.*?)!/gi)})),parcelRequire.register("531dJ",(function(e,t){$parcel$export(e.exports,"RegexpHandler",(()=>n));class n{static handAllFoundRegexp(e,t,n,r=!0){let i=null;for(;i=e.exec(t);){n(r?i[1].split(" ").join(""):i[1],i[0])}}}})),parcelRequire.register("hXJG5",(function(e,t){$parcel$export(e.exports,"Validator",(()=>r));var n=parcelRequire("fL8z2");class r{validators={login:[{validateHandler:e=>e.length<3,validateError:"Логин слишком короткий, от 3х символов"},{validateHandler:e=>e.length>20,validateError:"Логин слишком длинный, до 20ти символов"},{validateHandler:e=>/^[\d]{3,20}$/gm.test(e),validateError:"Логин не может состоять только из цифр"},{validateHandler:e=>!/^[0-9A-z_-]{3,20}$/gm.test(e),validateError:"от 3 до 20 символов, латиница, может содержать цифры, но не состоять из них, без пробелов, без спецсимволов (допустимы дефис и нижнее подчёркивание)"}],password:[{validateHandler:e=>e.length<8,validateError:"Пароль слишком короткий, от 8и символов"},{validateHandler:e=>e.length>40,validateError:"Пароль слишком длинный, до 40ти символов"},{validateHandler:e=>!/[A-Z]+/gm.test(e),validateError:"Пароль должен содержать хотя бы одну заглавную букву"},{validateHandler:e=>!/[0-9]+/gm.test(e),validateError:"Пароль должен содержать хотя бы цифру"}],firstName:[{validateHandler:e=>!/^[A-ZА-Я]{1}[a-zA-Zа-яА-Я-]*$/gm.test(e),validateError:n.FIRST_SECOND_NAME_ERROR}],secondName:[{validateHandler:e=>!/^[A-ZА-Я]{1}[a-zA-Zа-яА-Я-]*$/gm.test(e),validateError:n.FIRST_SECOND_NAME_ERROR}],displayLogin:[{validateHandler:e=>!e,validateError:"Не должно быть пустым"}],email:[{validateHandler:e=>!/^[0-9A-z]+@[0-9A-z]+\..+$/gm.test(e),validateError:"Не верный формат"}],phone:[{validateHandler:e=>!/^\+?\d{10,15}$/gm.test(e),validateError:"Неверный формат номера"}],message:[{validateHandler:e=>!!e,validateError:"Сообщение пустое"}]};validate(e,t){const n=this.validators[e];if(!n)throw new Error("Такого валидатора не существует.");for(const{validateHandler:e,validateError:r}of n)if(e(t))return r}}})),parcelRequire.register("fL8z2",(function(e,t){$parcel$export(e.exports,"FIRST_SECOND_NAME_ERROR",(()=>n));const n="латиница или кириллица, первая буква должна быть заглавной, без пробелов и без цифр, нет спецсимволов (допустим только дефис)"})),parcelRequire.register("lRRib",(function(e,t){$parcel$export(e.exports,"Input",(()=>i));var n=parcelRequire("iADmr"),r=parcelRequire("eCI4n");class i extends n.Block{constructor(e){super(r.inputTemplate,e)}}})),parcelRequire.register("eCI4n",(function(e,t){$parcel$export(e.exports,"inputTemplate",(()=>n));const n=new(0,parcelRequire("lsS9H").Template)('\n<div class="login_inputs">\n     <label class="input__with-label">\n          <span class="input__with-label_label">\n            {{ !labelName !}}\n          </span>\n          <input type="{{ !type !}}" value="{{!inputValue!}}" class="input__with-label_input" type="text" name="login" id="LOGIN">\n    </label>\n </div>\n')})),parcelRequire.register("7ImWG",(function(e,t){$parcel$export(e.exports,"MainBtn",(()=>i));var n=parcelRequire("iADmr"),r=parcelRequire("2tu5f");class i extends n.Block{constructor(e){super(r.mainBtnTemplate,e)}}})),parcelRequire.register("2tu5f",(function(e,t){$parcel$export(e.exports,"mainBtnTemplate",(()=>n));const n=new(0,parcelRequire("lsS9H").Template)('\n<button type="{{!type!}}" class="btn btn__main login_btn__main">\n    <span class="btn_text">\n        {{text}}\n    </span>\n</button>\n')})),parcelRequire.register("jAQYi",(function(e,t){$parcel$export(e.exports,"DefaultBtn",(()=>i));var n=parcelRequire("iADmr"),r=parcelRequire("95Aa5");class i extends n.Block{constructor(e){super(r.defaultBtnTemplate,e)}}})),parcelRequire.register("95Aa5",(function(e,t){$parcel$export(e.exports,"defaultBtnTemplate",(()=>n));const n=new(0,parcelRequire("lsS9H").Template)('\n    <button class="btn">\n       <span class="btn_text">\n         {{!text!}}\n        </span>\n     </button>\n    ')}))})();
//# sourceMappingURL=login.28a60305.js.map
